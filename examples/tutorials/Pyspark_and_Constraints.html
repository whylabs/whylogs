<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

<meta property="og:title" content="Data Validation for Spark Dataframes with whylogs" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://whylogs.readthedocs.io/examples/tutorials/Pyspark_and_Constraints.html" />
  
<meta property="og:description" content="🚩 Create a free WhyLabs account to get more value out of whylogs! Did you know you can store, visualize, and monitor whylogs profiles with the WhyLabs Observability Platform? Sign up for a free Why..." />
  <link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <meta name="generator" content="sphinx-4.3.2, furo 2022.09.29"/>
        <title>Data Validation for Spark Dataframes with whylogs - whylogs v1.1.37</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #263238;
  --color-code-foreground: #EEFFFF;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #263238;
  --color-code-foreground: #EEFFFF;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<div class="announcement">
  <aside class="announcement-content">
     <em>whylogs v1</em> has been launched! Make sure you checkout the
    <a href="/en/latest/migration/basics.html" alt="Link to migration guide">the migration guide</a> to ensure a smooth
    transition 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand"><div class='hidden'>whylogs</div>  <div class='version'> v1.1.37</div></div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/images/logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/images/logo.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text"><div class='hidden'>whylogs</div>  <div class='version'> v1.1.37</div></span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic/Getting_Started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../features/profiling.html">Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/writing.html">Writers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/data_validation.html">Data Validation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../datasets.html">Datasets</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../datasets/weather.html">Weather Forecast Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/weather.html">Weather Forecast Dataset - Usage Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../datasets/ecommerce.html">Ecommerce Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/ecommerce.html">Ecommerce Dataset - Usage Example</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../datasets/employee.html">Employee Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../datasets/employee.html">Employee Dataset - Usage Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Migration Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../migration/basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration/log_rotation.html">Log Rotation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/usage_statistics.html">Usage Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/whylabs/whylogs/releases">Changelog</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/whylabs/whylogs/issues/new/choose">Feedback</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/whylabs/whylogs">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://bit.ly/whylogs-slack">Slack</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/whylogs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/api/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/api/fugue/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.fugue</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/fugue/profiler/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.fugue.profiler</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/fugue/registry/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.fugue.registry</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/api/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/logger/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.logger</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/result_set/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.result_set</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/rolling/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.rolling</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/segment_cache/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.segment_cache</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/segment_processing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.segment_processing</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/logger/transient/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.logger.transient</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/api/reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.reader</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/reader/local/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.reader.local</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/reader/reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.reader.reader</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/reader/s3/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.reader.s3</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/api/store/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.store</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/store/local_store/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.store.local_store</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/store/profile_store/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.store.profile_store</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/store/query/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.store.query</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/store/sqlite_store/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.store.sqlite_store</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/api/usage_stats/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.usage_stats</span></code></a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/api/writer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/gcs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.gcs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/local/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.local</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/mlflow/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.mlflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/s3/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.s3</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/whylabs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.whylabs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/api/writer/writer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.writer.writer</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/api/annotations/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.api.annotations</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/constraints/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/cardinality_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.cardinality_metrics</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/condition_counts/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.condition_counts</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/count_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.count_metrics</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/distribution_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.distribution_metrics</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/frequent_items/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.frequent_items</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/constraints/factories/types_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.factories.types_metrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/constraints/metric_constraints/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.constraints.metric_constraints</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/aggregators/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.aggregators</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/column_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.column_metrics</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/compound_metric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.compound_metric</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/condition_count_metric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.condition_count_metric</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/decorators/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.decorators</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/deserializers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.deserializers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/maths/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.maths</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/metric_components/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.metric_components</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.metrics</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/multimetric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.multimetric</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/serializers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.serializers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/metrics/unicode_range/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metrics.unicode_range</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/model_performance_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.model_performance_metrics</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/model_performance_metrics/confusion_matrix/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.model_performance_metrics.confusion_matrix</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/model_performance_metrics/model_performance_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.model_performance_metrics.model_performance_metrics</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/model_performance_metrics/regression_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.model_performance_metrics.regression_metrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/proto/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../api/whylogs/core/proto/v0/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto.v0</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/proto/v0/v0_constraints_pb2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto.v0.v0_constraints_pb2</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/proto/v0/v0_messages_pb2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto.v0.v0_messages_pb2</span></code></a></li>
<li class="toctree-l6"><a class="reference internal" href="../../api/whylogs/core/proto/v0/v0_summaries_pb2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto.v0.v0_summaries_pb2</span></code></a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/proto/whylogs_messages_pb2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.proto.whylogs_messages_pb2</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/validators/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.validators</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/validators/condition_validator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.validators.condition_validator</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/validators/validator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.validators.validator</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/core/view/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.view</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/view/column_profile_view/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.view.column_profile_view</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/view/dataset_profile_view/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.view.dataset_profile_view</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/core/view/segmented_dataset_profile_view/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.view.segmented_dataset_profile_view</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/column_profile/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.column_profile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/common/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.common</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/configs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.configs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/dataset_profile/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.dataset_profile</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/datatypes/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.datatypes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/errors/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.errors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/feature_weights/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.feature_weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/input_resolver/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.input_resolver</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/metric_getters/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.metric_getters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/predicate_parser/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.predicate_parser</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/preprocessing/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.preprocessing</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/projectors/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.projectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/relations/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.relations</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/resolvers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.resolvers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/schema/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.schema</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/segment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.segment</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/segmentation_partition/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.segmentation_partition</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/core/specialized_resolvers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.core.specialized_resolvers</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/datasets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/descr/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.descr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/base/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.base</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/configs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.configs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/ecommerce/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.ecommerce</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/employee/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.employee</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/datasets/weather/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.datasets.weather</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/experimental/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/experimental/constraints_generation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.constraints_generation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/experimental/constraints_generation/condition_counts/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.constraints_generation.condition_counts</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/experimental/constraints_generation/count_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.constraints_generation.count_metrics</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/experimental/constraints_generation/types_metrics/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.constraints_generation.types_metrics</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/experimental/performance_estimation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.performance_estimation</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/experimental/performance_estimation/estimation_results/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.performance_estimation.estimation_results</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/experimental/performance_estimation/estimators/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.experimental.performance_estimation.estimators</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/migration/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.migration</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/migration/converters/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.migration.converters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/migration/uncompound/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.migration.uncompound</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/whylogs/viz/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/viz/drift/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.drift</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/viz/drift/column_drift_algorithms/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.drift.column_drift_algorithms</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/viz/drift/configs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.drift.configs</span></code></a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/whylogs/viz/enums/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.enums</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/whylogs/viz/enums/enums/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.enums.enums</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/viz/extensions/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.extensions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/viz/configs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.configs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/whylogs/viz/notebook_profile_viz/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">whylogs.viz.notebook_profile_viz</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<blockquote>
<div><p class="rubric" id="create-a-free-whylabs-account-to-get-more-value-out-of-whylogs">🚩 <em>Create a free WhyLabs account to get more value out of whylogs!</em></p>
<p><em>Did you know you can store, visualize, and monitor whylogs profiles with the</em> <a class="reference external" href="https://whylabs.ai/whylogs-free-signup?utm_source=whylogs-Github&amp;utm_medium=whylogs-example&amp;utm_campaign=Pyspark_Constraints">WhyLabs Observability Platform</a><em>? Sign up for a</em> <a class="reference external" href="https://whylabs.ai/whylogs-free-signup?utm_source=whylogs-Github&amp;utm_medium=whylogs-example&amp;utm_campaign=Pyspark_Constraints">free WhyLabs account</a> <em>to leverage the power of whylogs and WhyLabs together!</em></p>
</div></blockquote>
<section id="Data-Validation-for-Spark-Dataframes-with-whylogs">
<h1>Data Validation for Spark Dataframes with whylogs<a class="headerlink" href="#Data-Validation-for-Spark-Dataframes-with-whylogs" title="Permalink to this headline">#</a></h1>
<p><a class="reference external" href="https://colab.research.google.com/github/whylabs/whylogs/blob/mainline/python/examples/tutorials/Pyspark_and_Constraints.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>In this example, we will show how you can perform data validation for profiles that were created from a PySpark dataframe. This example is an advanced scenario that combines three topics. If you want to know more about each of these topics, please refer to the following tutorials:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://nbviewer.org/github/whylabs/whylogs/blob/mainline/python/examples/integrations/Pyspark_Profiling.ipynb">How to create a whylogs profile from a PySpark dataframe</a></p></li>
<li><p><a class="reference external" href="https://nbviewer.org/github/whylabs/whylogs/blob/mainline/python/examples/advanced/Condition_Count_Metrics.ipynb">How to create user defined condition count metrics</a></p></li>
<li><p><a class="reference external" href="https://nbviewer.org/github/whylabs/whylogs/blob/mainline/python/examples/basic/Constraints_Suite.ipynb">How to create and visualize constraints</a></p></li>
</ol>
<p>In this example, we will: - Create a PySpark dataframe - Create a whylogs profile from a PySpark dataframe - Create two condition count metrics to check date format and url addresses - Create and visualize a set of constraints based on the condition count and other standard metrics</p>
<section id="About-the-Dataset---🛏️-Airbnb-Listings-in-Rio-de-Janeiro,-Brazil">
<h2>About the Dataset - 🛏️ Airbnb Listings in Rio de Janeiro, Brazil<a class="headerlink" href="#About-the-Dataset---🛏️-Airbnb-Listings-in-Rio-de-Janeiro,-Brazil" title="Permalink to this headline">#</a></h2>
<p>We will read data made available from Airbnb. It’s a listing dataset from the city of Rio de Janeiro, Brazil. We’ll access data that was adapted from the following location: “<a class="reference external" href="http://data.insideairbnb.com/brazil/rj/rio-de-janeiro/2021-01-26/data/listings.csv.gz">http://data.insideairbnb.com/brazil/rj/rio-de-janeiro/2021-01-26/data/listings.csv.gz</a>”</p>
<p>In this example, we want to do some basic data validation. Let’s define those:</p>
<ul class="simple">
<li><p>Completeness Checks</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code> (long): should not contain any missing values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">listing_url</span></code> (string): should not contain any missing values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">last_review</span></code> (string): should not contain any missing values</p></li>
</ul>
</li>
<li><p>Consistency Checks</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">last_review</span></code> (string): date should be in the format YYYY-MM-DD</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">listing_url</span></code> (string): should be an url from airbnb (starting with <a class="reference external" href="https://www.airbnb.com/rooms/">https://www.airbnb.com/rooms/</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">longitude</span></code> (double): should be within the range of -24 to -22 and -44 to -43 respectively</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">room_type</span></code> (string): frequent strings should be in the set of expected values</p></li>
</ul>
</li>
<li><p>Statistics Checks</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">reviews_per_month</span></code> (double): standard deviation should be in expected range</p></li>
</ul>
</li>
</ul>
</section>
<section id="Installing-the-extra-dependency">
<h2>Installing the extra dependency<a class="headerlink" href="#Installing-the-extra-dependency" title="Permalink to this headline">#</a></h2>
<p>As we want to enable users to have exactly what they need to use from whylogs, the <code class="docutils literal notranslate"><span class="pre">pyspark</span></code> integration comes as an extra dependency. In order to have it available, simply uncomment and run the following cell:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: you may need to restart the kernel to use updated packages.</span>
<span class="o">%</span><span class="k">pip</span> install &#39;whylogs[spark]&#39;
</pre></div>
</div>
</div>
</section>
<section id="Initializing-a-SparkSession">
<h2>Initializing a SparkSession<a class="headerlink" href="#Initializing-a-SparkSession" title="Permalink to this headline">#</a></h2>
<p>Here we will initialize a SparkSession. I’m also setting the <code class="docutils literal notranslate"><span class="pre">pyarrow</span></code> execution config, because it makes our methods even more performant.</p>
<blockquote>
<div><p><strong>IMPORTANT</strong>: Make sure you have Spark 3.0+ available in your environment, as our implementation relies on it for a smoother integration</p>
</div></blockquote>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">appName</span><span class="p">(</span><span class="s1">&#39;whylogs-testing&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getOrCreate</span><span class="p">()</span>
<span class="n">arrow_config_key</span> <span class="o">=</span> <span class="s2">&quot;spark.sql.execution.arrow.pyspark.enabled&quot;</span>
<span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">arrow_config_key</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Creating-the-PySpark-dataframe">
<h2>Creating the PySpark dataframe<a class="headerlink" href="#Creating-the-PySpark-dataframe" title="Permalink to this headline">#</a></h2>
<p>This is a relatively small dataset, so we can run this example locally.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyspark</span> <span class="kn">import</span> <span class="n">SparkFiles</span>

<span class="n">data_url</span> <span class="o">=</span> <span class="s2">&quot;https://whylabs-public.s3.us-west-2.amazonaws.com/whylogs_examples/Listings/airbnb_listings.parquet&quot;</span>
<span class="n">spark</span><span class="o">.</span><span class="n">sparkContext</span><span class="o">.</span><span class="n">addFile</span><span class="p">(</span><span class="n">data_url</span><span class="p">)</span>

<span class="n">spark_dataframe</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">parquet</span><span class="p">(</span><span class="n">SparkFiles</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;airbnb_listings.parquet&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spark_dataframe</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-RECORD 0--------------------------------------
 name                   | Very Nice 2Br in ...
 description            | Discounts for lon...
 listing_url            | https://www.airbn...
 last_review            | 2020-12-26
 number_of_reviews_ltm  | 13
 number_of_reviews_l30d | 0
 id                     | 17878
 latitude               | -22.96592
 longitude              | -43.17896
 availability_365       | 286
 bedrooms               | 2.0
 bathrooms              | null
 reviews_per_month      | 2.01
 room_type              | Entire home/apt
only showing top 1 row

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spark_dataframe</span><span class="o">.</span><span class="n">printSchema</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
root
 |-- name: string (nullable = true)
 |-- description: string (nullable = true)
 |-- listing_url: string (nullable = true)
 |-- last_review: string (nullable = true)
 |-- number_of_reviews_ltm: long (nullable = true)
 |-- number_of_reviews_l30d: long (nullable = true)
 |-- id: long (nullable = true)
 |-- latitude: double (nullable = true)
 |-- longitude: double (nullable = true)
 |-- availability_365: long (nullable = true)
 |-- bedrooms: double (nullable = true)
 |-- bathrooms: double (nullable = true)
 |-- reviews_per_month: double (nullable = true)
 |-- room_type: string (nullable = true)

</pre></div></div>
</div>
</section>
<section id="Creating-the-Condition-Count-Metrics">
<h2>Creating the Condition Count Metrics<a class="headerlink" href="#Creating-the-Condition-Count-Metrics" title="Permalink to this headline">#</a></h2>
<p>To create a profile with the standard metrics, we can simply call <code class="docutils literal notranslate"><span class="pre">collect_dataset_profile_view</span></code> from whylog’s PySpark extra module. However, if we look at our defined set of constraints, there are two of those that need to checked agains individual values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">last_review</span></code> (string): date should be in the format YYYY-MM-DD</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">listing_url</span></code> (string): should be an url from airbnb (starting with <a class="reference external" href="https://www.airbnb.com/rooms/">https://www.airbnb.com/rooms/</a>)</p></li>
</ul>
<p>As opposed to the other constraints, that can be checked against aggregate metrics, these two need to be checked against individual values. For that, we will create two condition count metrics. Later on, we will create metric constraints based on these metrics.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">whylogs.core.relations</span> <span class="kn">import</span> <span class="n">Predicate</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>
<span class="kn">from</span> <span class="nn">whylogs.core.metrics.condition_count_metric</span> <span class="kn">import</span> <span class="n">Condition</span>
<span class="kn">from</span> <span class="nn">whylogs.core.schema</span> <span class="kn">import</span> <span class="n">DeclarativeSchema</span>
<span class="kn">from</span> <span class="nn">whylogs.core.resolvers</span> <span class="kn">import</span> <span class="n">STANDARD_RESOLVER</span>
<span class="kn">from</span> <span class="nn">whylogs.core.specialized_resolvers</span> <span class="kn">import</span> <span class="n">ConditionCountMetricSpec</span>

<span class="k">def</span> <span class="nf">date_format</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="n">date_format</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="n">last_review_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;is_date_format&quot;</span><span class="p">:</span> <span class="n">Condition</span><span class="p">(</span><span class="n">Predicate</span><span class="p">()</span><span class="o">.</span><span class="n">is_</span><span class="p">(</span><span class="n">date_format</span><span class="p">))}</span>
<span class="n">listing_url_conditions</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;url_matches_airbnb_domain&quot;</span><span class="p">:</span> <span class="n">Condition</span><span class="p">(</span><span class="n">Predicate</span><span class="p">()</span><span class="o">.</span><span class="n">matches</span><span class="p">(</span><span class="s2">&quot;^https:\/\/www.airbnb.com\/rooms&quot;</span><span class="p">))}</span>
</pre></div>
</div>
</div>
<p>Now that we have the our set of conditions for both columns, we can create the condition count metrics. We can do so by creating a Standard Schema and then extending it by adding the condition count metrics with <code class="docutils literal notranslate"><span class="pre">add_condition_count_metrics</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">schema</span> <span class="o">=</span> <span class="n">DeclarativeSchema</span><span class="p">(</span><span class="n">STANDARD_RESOLVER</span><span class="p">)</span>

<span class="n">schema</span><span class="o">.</span><span class="n">add_resolver_spec</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;last_review&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ConditionCountMetricSpec</span><span class="p">(</span><span class="n">last_review_conditions</span><span class="p">)])</span>
<span class="n">schema</span><span class="o">.</span><span class="n">add_resolver_spec</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;listing_url&quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">ConditionCountMetricSpec</span><span class="p">(</span><span class="n">listing_url_conditions</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<blockquote>
<div><p>To know more about condition count metrics and how to use them, check out the <a class="reference external" href="https://nbviewer.org/github/whylabs/whylogs/blob/mainline/python/examples/advanced/Metric_Constraints_with_Condition_Count_Metrics.ipynb">Metric Constraints with Condition Count Metrics</a> example.</p>
</div></blockquote>
</section>
<section id="Profiling-the-PySpark-DataFrame">
<h2>Profiling the PySpark DataFrame<a class="headerlink" href="#Profiling-the-PySpark-DataFrame" title="Permalink to this headline">#</a></h2>
<p>Now, we can use the schema to pass to our logger through <code class="docutils literal notranslate"><span class="pre">collect_dataset_profile_view</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whylogs.api.pyspark.experimental</span> <span class="kn">import</span> <span class="n">collect_dataset_profile_view</span>

<span class="n">dataset_profile_view</span> <span class="o">=</span> <span class="n">collect_dataset_profile_view</span><span class="p">(</span><span class="n">input_df</span><span class="o">=</span><span class="n">spark_dataframe</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<p>This will create a profile with the standard metrics, as well as the two condition count metrics that we created. As a sanity check, let’s see the metrics for the <code class="docutils literal notranslate"><span class="pre">last_review</span></code> column:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_profile_view</span><span class="o">.</span><span class="n">get_column</span><span class="p">(</span><span class="s2">&quot;last_review&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_metric_names</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;types&#39;,
 &#39;cardinality&#39;,
 &#39;counts&#39;,
 &#39;distribution&#39;,
 &#39;frequent_items&#39;,
 &#39;condition_count&#39;]
</pre></div></div>
</div>
</section>
<section id="Creating-and-Visualizing-Metric-Constraints">
<h2>Creating and Visualizing Metric Constraints<a class="headerlink" href="#Creating-and-Visualizing-Metric-Constraints" title="Permalink to this headline">#</a></h2>
<p>We have all that we need to build our set of constraints. We will use out-of-the-box factory constraints to do that:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whylogs.core.constraints.factories</span> <span class="kn">import</span> <span class="n">condition_meets</span>
<span class="kn">from</span> <span class="nn">whylogs.core.constraints</span> <span class="kn">import</span> <span class="n">ConstraintsBuilder</span>
<span class="kn">from</span> <span class="nn">whylogs.core.constraints.factories</span> <span class="kn">import</span> <span class="n">no_missing_values</span>
<span class="kn">from</span> <span class="nn">whylogs.core.constraints.factories</span> <span class="kn">import</span> <span class="n">is_in_range</span>
<span class="kn">from</span> <span class="nn">whylogs.core.constraints.factories</span> <span class="kn">import</span> <span class="n">stddev_between_range</span>
<span class="kn">from</span> <span class="nn">whylogs.core.constraints.factories</span> <span class="kn">import</span> <span class="n">frequent_strings_in_reference_set</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">ConstraintsBuilder</span><span class="p">(</span><span class="n">dataset_profile_view</span><span class="o">=</span><span class="n">dataset_profile_view</span><span class="p">)</span>
<span class="n">reference_set</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Entire home/apt&quot;</span><span class="p">,</span> <span class="s2">&quot;Private room&quot;</span><span class="p">,</span> <span class="s2">&quot;Shared room&quot;</span><span class="p">,</span> <span class="s2">&quot;Hotel room&quot;</span><span class="p">}</span>

<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">condition_meets</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;last_review&quot;</span><span class="p">,</span> <span class="n">condition_name</span><span class="o">=</span><span class="s2">&quot;is_date_format&quot;</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">condition_meets</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;listing_url&quot;</span><span class="p">,</span> <span class="n">condition_name</span><span class="o">=</span><span class="s2">&quot;url_matches_airbnb_domain&quot;</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">no_missing_values</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;last_review&quot;</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">no_missing_values</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;listing_url&quot;</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">is_in_range</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span><span class="n">lower</span><span class="o">=-</span><span class="mi">24</span><span class="p">,</span><span class="n">upper</span><span class="o">=-</span><span class="mi">22</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">is_in_range</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span><span class="n">lower</span><span class="o">=-</span><span class="mi">44</span><span class="p">,</span><span class="n">upper</span><span class="o">=-</span><span class="mi">43</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">no_missing_values</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">stddev_between_range</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;reviews_per_month&quot;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">1.1</span><span class="p">))</span>
<span class="n">builder</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="n">frequent_strings_in_reference_set</span><span class="p">(</span><span class="n">column_name</span><span class="o">=</span><span class="s2">&quot;room_type&quot;</span><span class="p">,</span> <span class="n">reference_set</span><span class="o">=</span><span class="n">reference_set</span><span class="p">))</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
<span class="n">constraints</span><span class="o">.</span><span class="n">generate_constraints_report</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ReportResult(name=&#39;last_review meets condition is_date_format&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;last_review has no missing values&#39;, passed=0, failed=1, summary=None),
 ReportResult(name=&#39;listing_url meets condition url_matches_airbnb_domain&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;listing_url has no missing values&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;latitude is in range [-24,-22]&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;longitude is in range [-44,-43]&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;id has no missing values&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#39;reviews_per_month standard deviation between 0.8 and 1.1 (inclusive)&#39;, passed=1, failed=0, summary=None),
 ReportResult(name=&#34;room_type values in set {&#39;Shared room&#39;, &#39;Hotel room&#39;, &#39;Private room&#39;, &#39;Entire home/apt&#39;}&#34;, passed=1, failed=0, summary=None)]
</pre></div></div>
</div>
<blockquote>
<div><p>If you’re interested in a more complete list of helper constraints, please check out the <a class="reference external" href="https://nbviewer.org/github/whylabs/whylogs/blob/mainline/python/examples/basic/Constraints_Suite.ipynb">Constraints Suite</a> example.</p>
</div></blockquote>
<p>Now, we can visualize the constraints report using the <strong>Notebook Profile Visualizer</strong>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">whylogs.viz</span> <span class="kn">import</span> <span class="n">NotebookProfileVisualizer</span>

<span class="n">visualization</span> <span class="o">=</span> <span class="n">NotebookProfileVisualizer</span><span class="p">()</span>
<span class="n">visualization</span><span class="o">.</span><span class="n">constraints_report</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">cell_height</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Connection error. Skip stats collection.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div></div><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot; /&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt;
    &lt;meta name=&quot;description&quot; content=&quot;&quot; /&gt;
    &lt;meta name=&quot;author&quot; content=&quot;&quot; /&gt;

    &lt;title&gt;Profile Visualizer | whylogs&lt;/title&gt;

    &lt;link rel=&quot;icon&quot; href=&quot;images/whylabs-favicon.png&quot; type=&quot;image/png&quot; sizes=&quot;16x16&quot; /&gt;
    &lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.googleapis.com&quot; /&gt;
    &lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.gstatic.com&quot; crossorigin /&gt;
    &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Asap:wght@400;500;600;700&amp;display=swap&quot; rel=&quot;stylesheet&quot; /&gt;
    &lt;link rel=&quot;preconnect&quot; href=&quot;https://fonts.gstatic.com&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css&quot; /&gt;

    &lt;script
      src=&quot;https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.7/handlebars.min.js&quot;
      integrity=&quot;sha512-RNLkV3d+aLtfcpEyFG8jRbnWHxUqVZozacROI4J2F1sTaDqo1dPQYs01OMi1t1w9Y2FdbSCDSQ2ZVdAC8bzgAg==&quot;
      crossorigin=&quot;anonymous&quot;
      referrerpolicy=&quot;no-referrer&quot;
    &gt;&lt;/script&gt;

    &lt;style type=&quot;text/css&quot;&gt;

      /* Screen on smaller screens */
      .no-responsive {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1031;
        width: 100vw;
        height: 100vh;
        background-color: var(--tealBackground);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      @media screen and (min-width: 1000px) {
        .desktop-content {
          display: block;
        }
        .no-responsive {
          display: none;
        }
      }

      .no-responsive__content {
        max-width: 600px;
        width: 100%;
        padding: 0 24px;
      }

      .no-responsive__title {
        font-size: 96px;
        font-weight: 300;
        color: var(--brandSecondary900);
        line-height: 1.167;
      }

      .no-responsive__text {
        margin: 0;
        font-size: 16px;
        font-weight: 400;
        color: var(--brandSecondary900);
        line-height: 1.5;
      }

      .header-title {
        font-size: 26px;
        font-weight: 700;
        color: #444444;
      }

      .tooltip-full-number {
        position: relative;
        display: inline-block;
      }

      .tooltip-full-number .tooltiptext {
        visibility: hidden;
        background: black;
        color: white;
        border: 1px solid black;
        text-align: start;
        padding: 3px;
        position: absolute;
        z-index: 1;
        top: 0;
        left: 100%;
        margin-left: 5px;
        opacity: 0;
        transition: opacity 0.5s;
        font-size: 13px;
        font-weight: normal;
        line-height: 100%;
      }

      .tooltip-full-number:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
      }


      .wl-compare-profile {
        position: relative;
        left: 0;
        padding: 30px;
        margin-bottom: 20px;
        background: var(--white);;
        border-bottom: 1px solid #CED4DA;
      }

      .alert-list {
        padding: 30px;
        padding-top: 0;
      }

    .drift-detection {
       justify-content: space-between;
       align-items: center;
     }

     .drift-detection-info-circle {
       width: 15px;
       height: 15px;
       border-radius: 50px;
       display: inline-block;
       margin-right: 8px;
     }

     .drift-detection-info-drifts-item {
         padding-right: 20px;
     }

     .drift-detection-info-title {
       font-family: Arial;
       font-weight: bold;
       font-size: 22px;
       line-height: 130%;
       color: #313B3D;
     }

     .drift-detection-info-drifts-item-count {
       font-family: Arial;
       font-weight: bold;
       font-size: 14px;
       line-height: 16px;
       color: #000000;
       padding-right: 8px;
     }

     .drift-detection-info-drifts-item-name {
       font-family: Arial;
       font-style: normal;
       font-weight: normal;
       font-size: 12px;
       line-height: 14px;
       color: #000000;
     }

     .drift-detection-search-input {
       display: flex;
       align-items: center;
       background: rgba(255, 255, 255, 0.7);
       border: 1px solid #DBE5E7;
       box-sizing: border-box;
       border-radius: 4px;
       width: 170px;
       padding-left: 10px;
     }

     .drift-detection-search-input img{
       margin-right: 5px;
     }

     .drift-detection-search-input input::placeholder {
       font-family: Arial;
       font-weight: normal;
       font-size: 13px;
       line-height: 16px;
       color: #313B3D;
     }

     .dropdown-container {
       position: absolute;
       right: 30px;
       top: 80px;
       z-index: 999;
       background: #FFFFFF;
       border: 1px solid #DBE5E7;
       box-sizing: border-box;
       box-shadow: 0px 2px 8px rgba(0, 0, 0, 0.05);
       border-radius: 4px;
       padding: 10px !important;
       border: none !important;
     }

     .filter-options-title {
       width: 240px;
     }

     .filter-options-title p {
       margin: 0;
     }

     .form-check-input:checked {
       background-color: #0E7384;
       border-color: #0E7384;
     }

     .form-check-input[type=checkbox] {
       border-radius: 2px;
     }

     .search-input{
       padding-top: 0 !important;
       padding-bottom: 0 !important;
     }

     .search-input input{
       border: none;
       background: none;
       outline: none;
       height: 40px;
       width: 100%;
       font-size: 14px;
     }

     .search-input img{
       height: 19px;
       pointer-events: none;
     }

     input::placeholder {
       color: var(--secondaryLight1000);
     }

      .statistics {
        width: 100%;
      }

     .close-filter-button {
       display: flex;
       justify-content: center;
       align-items: center;
       background: rgba(255, 255, 255, 0.7);
       border: 1px solid #369BAC;
       box-sizing: border-box;
       border-radius: 4px;
       width: 40px;
       height: 40px;
       cursor: pointer;
       margin-left: 10px;
     }

      .statistic-number-title {
        font-family: Arial;
        font-weight: normal;
        font-size: 14px;
        line-height: 20px;
        color: #6C757D;
      }

      .statistic-number {
        font-family: Arial;
        font-weight: bold;
        font-size: 20px;
        line-height: 140%;
        display: flex;
        align-items: center;
        color: #4F595B;
      }

      .full-summary-statistics-wrap {
        padding: 20px;
      }

      .statistics {
        width: 100%;
      }

      .statistics-list {
        width: 100% ;
      }

      mark {
        padding: 5px;
        border-radius: 4px;
        font-family: Arial;
        font-weight: normal;
        font-size: 14px;
        line-height: 140%;
      }

      .blue-mark {
        background-color:  #369BAC1A;
        color: #369BAC;
      }

      .red-mark {
        background-color: #FFEFEE;
        color: #F5473C;
      }

      .alert-tag {
        height: 27px;
        padding: 5px;
        border-radius: 4px;
        font-family: Arial;
        font-weight: bold;
        font-size: 12px;
        line-height: 140%;
        color: #FFFFFF;
      }

      .turquoise-background-color {
        background-color: #1DBB42;
      }

      .bordeaux-background-color {
        background-color: #C6462A;
      }

      .border-solid-gray {
        border: 1px solid #CED4DA;
        border-radius: 4px;
      }

      .display-flex {
        display: flex;
      }

      .justify-content-space-between {
        justify-content: space-between;
      }

      .justify-content-center {
        justify-content: center;
      }

      .align-items-center {
        align-items: center;
      }

      .align-items-flex-start {
        align-items: flex-start;
      }

      .padding-right-30 {
        padding-right: 30px;
      }

      .notif-circle-container{
        position: absolute;
        top: 25px;
        right: 25px;
        padding: 5.3px;
        border-radius: 50%;
        background-color: white;
        cursor: pointer;
      }

      .notif-circle {
        position: absolute;
        top: 2px;
        right: 2px;
        padding: 3.3px;
        border-radius: 50%;
        background-color: #F2994A;
      }

      .alert-list-text {
        width: 70%
      }

     @media screen and (min-width: 500px) {
       .desktop-content {
         display: block;
       }
       .no-responsive {
         display: none;
       }
     }
    &lt;/style&gt;
  &lt;/head&gt;

  &lt;body id=&quot;generated-html&quot;&gt;&lt;/body&gt;

  &lt;script id=&quot;entry-template&quot; type=&quot;text/x-handlebars-template&quot;&gt;

      &lt;div class=&quot;desktop-content&quot;&gt;
        &lt;div class=&quot;full-summary-statistics-wrap&quot;&gt;
          &lt;div class=&quot;full-summary-statistics&quot;&gt;
            &lt;div&gt;
              &lt;div class=&quot;display-flex justify-content-center&quot;&gt;
                &lt;div class=&quot;statistics-list border-solid-gray&quot;&gt;
                  &lt;div&gt;
                    &lt;div class=&quot;wl-compare-profile&quot; id=&quot;compare-profile&quot;&gt;
                        &lt;div class=&quot;drift-detection-wrap&quot;&gt;
                          &lt;div class=&quot;drift-detection display-flex align-items-flex-start&quot;&gt;
                            &lt;div class=&quot;drift-detection-info flex-direction-colum&quot;&gt;
                              &lt;div class=&quot;drift-detection-info-title-wrap display-flex&quot;&gt;
                                &lt;p class=&quot;drift-detection-info-title&quot;&gt;
                                  Constraints Report
                                &lt;/p&gt;
                              &lt;/div&gt;

                              &lt;!-- &lt;/div&gt; --&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;drift-detection-search-input-wrap display-flex&quot;&gt;
                              &lt;div class=&quot;drift-detection-search-input search-input&quot;&gt;
                                &lt;input type=&quot;text&quot; id=&quot;wl__feature-search&quot; placeholder=&quot;Quick search...&quot;/&gt;
                                &lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGdSURBVHgBpZK7TkJBEIZnZoVocdTYyQNALxpNKPQBMEaNJsbCRMKhl8ISWwt6AaksCF5iTHgAGhJD4AHkAaAzGiwUsjvOQnO4SYh/cXbPzO43OxcEj9Zy92EiFSXNIfvPyE1kKFfdoxJMENpP6DrvLC0vJoEwCgwto7DWcxoIIHBYbA3NmKwnDltjAeuZhyul1DaTTlfPB6Nt5Z53DOgky4P875+nlctY2+unjZviLklkJhi5bPUa3y/7qJuQUM7PinMy7CdQc1Gh16vnBxPzrMROmlKQEgKNASAHLQCmSIGpS75O+O5pdQAgVXaIqTkNwDDXHmcnW3VmHZoGMLoTsOt88+NrAMCIZdu+iLTyTwKRa1Md6YKfOgXbzO7K8sWku5u5RxcRV5EpPezrzcHGbXEXWaUkgkweZ/UC9YrK3zqggFw5FBZfm8EUavHj7AjAKpIvBDrGn+pNnlcyhYgqbcC41idr1gvB4SdZkDbzQa21gwv0Vj07aPTtL07XdDOyDXohCDNoHIRmAVRie20f+RKybRDQDvxHkXy/7b/DrayncLbMwQAAAABJRU5ErkJggg==&quot;/&gt;
                              &lt;/div&gt;
                              &lt;div class=&quot;wl__dropdown_arrow-icon&quot;&gt;
                                &lt;div onclick=&quot;openFilter()&quot; class=&quot;close-filter-button&quot;&gt;
                                &lt;div class=&quot;display-flex close-filter-icon d-none&quot;&gt;
                                  &lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAALCAYAAACprHcmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADFSURBVHgBfY+xDcIwEEXvnLQBZQkYAEhDwwKpEEK0CCZgAEjJCEmgjYSAygxAHTZgFRSOsyUjY5mcZFnn/+78PwBXf3+MoKWUPuYjVBPFnTwpr9t/oNJfcTfXsAhRAlDqDhhQIPYgpAqNMDqcUqSAYZT1epr9gAHt6uXshvYme4DYHQJNDKh0dD0m5WXB10Y3Fqjtuh7fROn3oREDWxfeMLyRsMnc0OgDzdduaA0Pi3Plgr7Q2kaAePeBqh6rueSNBVt6fgCwBV1JLF3rlAAAAABJRU5ErkJggg==&quot;/&gt;
                                &lt;/div&gt;
                                &lt;div class=&quot;display-flex filter-icon&quot;&gt;
                                  &lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACSSURBVHgBrZLBCYAwDEWTUjw7igcdwI1cxkNXUJzBEVzFAbSVKoKmaVrEB6GHJv/w+AACtRk7P9IONv1QOYUl96k0zv61m2tjARoLtSDI3EFsgIJ4uoXrMLazO72CRG2mzg/8BSdVlEjhpGZJjAWdAZJECpWalEhJSs1pHuUlMad5FFai1Lwg4Ckx1TxKIPFL8w55mEWd8VjPGAAAAABJRU5ErkJggg==&quot;/&gt;
                                &lt;/div&gt;
                                &lt;/div&gt;
                              &lt;span class=&quot;notif-circle-container&quot;&gt;
                                &lt;span class=&quot;notif-circle&quot;&gt;&lt;/span&gt;
                              &lt;/span&gt;
                            &lt;/div&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;dropdown-container flex-direction-colum mb-2 d-none&quot; id=&quot;dropdown-container&quot;&gt;
                          &lt;div class=&quot;filter-options&quot;&gt;
                            &lt;div class=&quot;filter-options-title space-between dropdown&quot;&gt;
                              &lt;p&gt;Select a view:&lt;/p&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;form-check mb-1 mt-2&quot;&gt;
                              &lt;input
                                class=&quot;form-check-input wl__feature-filter-input&quot;
                                type=&quot;checkbox&quot;
                                name=&quot;checkbox&quot;
                                value=&quot;Discrete&quot;
                                id=&quot;inferredDiscrete&quot;
                                checked
                              /&gt;
                              &lt;label class=&quot;form-check-label&quot; for=&quot;inferredDiscrete&quot;&gt;
                                Failed constraints (&lt;span class=&quot;wl__feature-count--discrete&quot;&gt;&lt;/span&gt;)
                              &lt;/label&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;form-check mb-1&quot;&gt;
                              &lt;input
                                class=&quot;form-check-input wl__feature-filter-input&quot;
                                type=&quot;checkbox&quot;
                                name=&quot;checkbox&quot;
                                value=&quot;Non-discrete&quot;
                                id=&quot;inferredNonDiscrete&quot;
                                checked
                              /&gt;
                              &lt;label class=&quot;form-check-label&quot; for=&quot;inferredNonDiscrete&quot;&gt;
                                Passed constraints (&lt;span
                                  class=&quot;wl__feature-count--non-discrete&quot;
                                &gt;&lt;/span&gt;)
                              &lt;/label&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;form-check mb-1&quot;&gt;
                              &lt;input
                                class=&quot;form-check-input wl__feature-filter-input&quot;
                                type=&quot;checkbox&quot;
                                name=&quot;checkbox&quot;
                                value=&quot;Unknown&quot;
                                id=&quot;inferredUnknown&quot;
                                checked
                              /&gt;
                              &lt;label class=&quot;form-check-label&quot; for=&quot;inferredUnknown&quot;&gt;
                                All constraints (&lt;span class=&quot;wl__feature-count--unknown&quot;&gt;&lt;/span&gt;)
                              &lt;/label&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;div class=&quot;alert-list&quot; id=&quot;alert-list&quot;&gt;
                      {{{alertLIst this}}}
                    &lt;/div&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
      &lt;div class=&quot;no-responsive&quot;&gt;
        &lt;div class=&quot;no-responsive__content&quot;&gt;
          &lt;h1 class=&quot;no-responsive__title&quot;&gt;Hold on! :)&lt;/h1&gt;
          &lt;p class=&quot;no-responsive__text&quot;&gt;
            It looks like your current screen size or device is not yet supported by the WhyLabs Sandbox. The Sandbox is
            best experienced on a desktop computer. Please try maximizing this window or switching to another device. We
            are working on adding support for a larger variety of devices.
          &lt;/p&gt;
        &lt;/div&gt;
      &lt;/div&gt;

  &lt;/script&gt;

  &lt;script src=&quot;https://code.jquery.com/jquery-3.6.0.min.js&quot; integrity=&quot;sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;

  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/d3/6.7.0/d3.min.js&quot; integrity=&quot;sha512-cd6CHE+XWDQ33ElJqsi0MdNte3S+bQY819f7p3NUHgwQQLXSKjE4cPZTeGNI+vaxZynk1wVU3hoHmow3m089wA==&quot; crossorigin=&quot;anonymous&quot; referrerpolicy=&quot;no-referrer&quot;&gt;&lt;/script&gt;

  &lt;script&gt;
    function registerHandlebarHelperFunctions() {
      //helper fun
      function formatLabelDate(timestamp) {
        const date = new Date(timestamp);
        const format = d3.timeFormat(&quot;%Y-%m-%d %I:%M:%S %p %Z&quot;);
        return format(date);
      }

      function fixNumberTo(number, decimals = 3) {
        return parseFloat(number).toFixed(decimals);
      }

      const randomNumbers = (range) =&gt; Math.floor(Math.random() * range)

      const findFetureWithNumberSummary = (column) =&gt; {
        const fetureIndex = Object.values(column.columns)
              .findIndex((feture) =&gt; feture.numberSummary)

        return Object.keys(column.columns)[fetureIndex]
      }

      const alertListItemStatus = (status, passedItem, failedItem) =&gt; {
        if (status) {
          return passedItem
        } else {
          return failedItem
        }
      }

      const alertListElement = (name, text, status, summary) =&gt; {
        if (summary == null){
          return (
          `&lt;div
             data-inferred-type=${alertListItemStatus(status, &quot;passed&quot;, &quot;failed&quot;)}
             class=&quot;alert-list-item display-flex justify-content-space-between align-items-center mb-2&quot;
           &gt;
            &lt;div class=&quot;alert-list-text&quot;&gt;
              ${
                name &amp;&amp;
                alertListItemStatus(
                  status,
                  `&lt;mark class=&quot;blue-mark&quot;&gt;${name}&lt;/mark&gt;`,
                  `&lt;mark class=&quot;red-mark&quot;&gt;${name}&lt;/mark&gt;`
                )
              }
              ${text}
            &lt;/div&gt;
              ${
                alertListItemStatus(
                  status,
                  `
                  &lt;div class=&quot;turquoise-background-color alert-tag&quot;&gt;Passed&lt;/div&gt;
                  `
                  ,
                  `
                  &lt;div class=&quot;bordeaux-background-color alert-tag&quot;&gt;Failed&lt;/div&gt;
                  `
                )
              }
              &lt;/div&gt;`
        )

        }
        return (
          `&lt;div
             data-inferred-type=${alertListItemStatus(status, &quot;passed&quot;, &quot;failed&quot;)}
             class=&quot;alert-list-item display-flex justify-content-space-between align-items-center mb-2&quot;
           &gt;
            &lt;div class=&quot;alert-list-text&quot;&gt;
              ${
                name &amp;&amp;
                alertListItemStatus(
                  status,
                  `&lt;mark class=&quot;blue-mark&quot;&gt;${name}&lt;/mark&gt;`,
                  `&lt;mark class=&quot;red-mark&quot;&gt;${name}&lt;/mark&gt;`
                )
              }
              ${text}
            &lt;/div&gt;
              ${
                alertListItemStatus(
                  status,
                  `
                  &lt;div class=&quot;tooltip-full-number&quot;&gt;
                    &lt;div class=&quot;turquoise-background-color alert-tag&quot;&gt;Passed
                      &lt;span class=&quot;tooltiptext&quot;&gt;
                          &lt;pre class=&quot;mb-1&quot;&gt; ${JSON.stringify(summary, null, 2)} &lt;/pre&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;`

                  ,
                  `
                  &lt;div class=&quot;tooltip-full-number&quot;&gt;
                    &lt;div class=&quot;bordeaux-background-color alert-tag&quot;&gt;Failed
                      &lt;span class=&quot;tooltiptext&quot;&gt;
                        &lt;pre class=&quot;mb-1&quot;&gt; ${JSON.stringify(summary, null, 2)} &lt;/pre&gt;
                        &lt;/span&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;`
                )
              }
              &lt;/div&gt;`
        )
      }

      let failedConstraints = 0;

      Handlebars.registerHelper(&quot;getProfileTimeStamp&quot;, function (column) {
        return formatLabelDate(+column.properties.dataTimestamp)
      });

      Handlebars.registerHelper(&quot;getProfileName&quot;, function (column) {
        return column.properties.tags.name
      });


      Handlebars.registerHelper(&quot;alertLIst&quot;, function (column) {
        let alertListItem = column.map((value) =&gt; {
          if (value[1][0]) {
            let alertListValue = value[1].map((cstr)=&gt;{
              return alertListElement(value[0],cstr[0],cstr[cstr.length - 1] === 0 || (failedConstraints++, false), value[3])
            })
            return alertListValue.join(&#x27; &#x27;)
          } else {
            return alertListElement(&#x27;&#x27;, value[0], value[2] === 0 ||  (failedConstraints++, false), value[3])
          }
        })
         $(document).ready(() =&gt; {
           $(&quot;.wl__feature-count--discrete&quot;).append(failedConstraints)
           $(&quot;.wl__feature-count--non-discrete&quot;).append(column.length - failedConstraints)
           $(&quot;.wl__feature-count--unknown&quot;).append(column.length)
         })
        return alertListItem.join(&#x27; &#x27;)
      });

    }

    function openFilter() {
      const $filterOptions = $(&quot;.dropdown-container&quot;);
      const filterClass = $filterOptions.attr(&quot;class&quot;);

      if (filterClass.indexOf(&quot;d-none&quot;) &gt; 0) {
        $filterOptions.removeClass(&quot;d-none&quot;);
        $(&quot;.filter-icon&quot;).addClass(&quot;d-none&quot;)
        $(&quot;.close-filter-icon&quot;).removeClass(&quot;d-none&quot;)
      } else {
        $filterOptions.addClass(&quot;d-none&quot;);
        $(&quot;.close-filter-icon&quot;).addClass(&quot;d-none&quot;)
        $(&quot;.filter-icon&quot;).removeClass(&quot;d-none&quot;)
      }
    }

    function initHandlebarsTemplate() {
      // Replace this context with JSON from .py file
      const context = [[&quot;last_review meets condition is_date_format&quot;, 1, 0, {&quot;metric&quot;: &quot;condition_count&quot;, &quot;total&quot;: 16465, &quot;is_date_format&quot;: 16465}], [&quot;last_review has no missing values&quot;, 0, 1, {&quot;metric&quot;: &quot;counts&quot;, &quot;n&quot;: 26106, &quot;null&quot;: 9641, &quot;nan&quot;: 0, &quot;inf&quot;: 0}], [&quot;listing_url meets condition url_matches_airbnb_domain&quot;, 1, 0, {&quot;metric&quot;: &quot;condition_count&quot;, &quot;total&quot;: 26106, &quot;url_matches_airbnb_domain&quot;: 26106}], [&quot;listing_url has no missing values&quot;, 1, 0, {&quot;metric&quot;: &quot;counts&quot;, &quot;n&quot;: 26106, &quot;null&quot;: 0, &quot;nan&quot;: 0, &quot;inf&quot;: 0}], [&quot;latitude is in range [-24,-22]&quot;, 1, 0, {&quot;metric&quot;: &quot;distribution&quot;, &quot;mean&quot;: -22.965736037217624, &quot;stddev&quot;: 0.03505941949491759, &quot;n&quot;: 26106, &quot;max&quot;: -22.74982, &quot;min&quot;: -23.07292, &quot;q_01&quot;: -23.02806, &quot;q_05&quot;: -23.01204, &quot;q_10&quot;: -23.00693, &quot;q_25&quot;: -22.98454, &quot;median&quot;: -22.97157, &quot;q_75&quot;: -22.95076, &quot;q_90&quot;: -22.91718, &quot;q_95&quot;: -22.90981, &quot;q_99&quot;: -22.83753}], [&quot;longitude is in range [-44,-43]&quot;, 1, 0, {&quot;metric&quot;: &quot;distribution&quot;, &quot;mean&quot;: -43.24905026415256, &quot;stddev&quot;: 0.0965622753402193, &quot;n&quot;: 26106, &quot;max&quot;: -43.10486, &quot;min&quot;: -43.70479, &quot;q_01&quot;: -43.52144, &quot;q_05&quot;: -43.45984, &quot;q_10&quot;: -43.40554, &quot;q_25&quot;: -43.30428, &quot;median&quot;: -43.19638, &quot;q_75&quot;: -43.18631, &quot;q_90&quot;: -43.17741, &quot;q_95&quot;: -43.17483, &quot;q_99&quot;: -43.16903}], [&quot;id has no missing values&quot;, 1, 0, {&quot;metric&quot;: &quot;counts&quot;, &quot;n&quot;: 26106, &quot;null&quot;: 0, &quot;nan&quot;: 0, &quot;inf&quot;: 0}], [&quot;reviews_per_month standard deviation between 0.8 and 1.1 (inclusive)&quot;, 1, 0, {&quot;metric&quot;: &quot;distribution&quot;, &quot;mean&quot;: 0.6285800182204677, &quot;stddev&quot;: 0.8569652523205165, &quot;n&quot;: 16465, &quot;max&quot;: 25.0, &quot;min&quot;: 0.01, &quot;q_01&quot;: 0.02, &quot;q_05&quot;: 0.03, &quot;q_10&quot;: 0.05, &quot;q_25&quot;: 0.09, &quot;median&quot;: 0.27, &quot;q_75&quot;: 0.91, &quot;q_90&quot;: 1.7, &quot;q_95&quot;: 2.32, &quot;q_99&quot;: 3.81}], [&quot;room_type values in set {&#x27;Shared room&#x27;, &#x27;Hotel room&#x27;, &#x27;Private room&#x27;, &#x27;Entire home/apt&#x27;}&quot;, 1, 0, {&quot;metric&quot;: &quot;frequent_items&quot;, &quot;frequent_strings_top_10&quot;: [&quot;Entire home/apt:18876&quot;, &quot;Private room:6512&quot;, &quot;Shared room:604&quot;, &quot;Hotel room:114&quot;]}]];
      // Config handlebars and pass data to HBS template
      const source = document.getElementById(&quot;entry-template&quot;).innerHTML;
      const template = Handlebars.compile(source);
      const html = template(context);
      const target = document.getElementById(&quot;generated-html&quot;);
      target.innerHTML = html;
    }

    function initWebsiteScripts() {
      const $featureSearch = document.getElementById(&quot;wl__feature-search&quot;);
      const $alertList = document.getElementById(&quot;alert-list&quot;);
      const $discrete = document.getElementById(&quot;inferredDiscrete&quot;);
      const $nonDiscrete = document.getElementById(&quot;inferredNonDiscrete&quot;);
      const $unknown = document.getElementById(&quot;inferredUnknown&quot;);

      const activeTypes = {
        passed: true,
        failed: true
      };

      let searchString = &quot;&quot;;

      function debounce(func, wait, immediate) {
        let timeout;

        return function () {
          const context = this;
          const args = arguments;
          const later = function () {
            timeout = null;
            if (!immediate) func.apply(context, args);
          };

          const callNow = immediate &amp;&amp; !timeout;
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
          if (callNow) func.apply(context, args);
        };
      }

      function filterNotification() {
        const $notifCircleContainer = $(&quot;.notif-circle-container&quot;)
        const $boxes = $(&#x27;.wl_filter-options&gt;.form-check&gt;input[name=checkbox]:checked&#x27;);
        const item = Object.values($boxes).find(function(value) { return $(value)[0] === undefined});
        if (item === undefined) {
          $notifCircleContainer.removeClass(&quot;d-none&quot;)
        } else {
          $notifCircleContainer.addClass(&quot;d-none&quot;)
        }
      }

      function handleSearch() {
        const tableBodyChildren = $alertList.children;

        for (let i = 0; i &lt; tableBodyChildren.length; i++) {
          const type = tableBodyChildren[i].dataset.inferredType.toLowerCase();
          const name = $(tableBodyChildren[i].children[0]).html().toLowerCase();
          if (activeTypes[type] &amp;&amp; name.includes(searchString)) {
            tableBodyChildren[i].style.display = &quot;&quot;;
          } else {
            tableBodyChildren[i].style.display = &quot;none&quot;;
          }
        }
      }

      const checkedBoxes = () =&gt; {
        if ($(&#x27;.form-check-input:checked&#x27;).length === $(&quot;.form-check-input&quot;).length - 1) {
          $($(&quot;.form-check-input&quot;)[$(&quot;.form-check-input&quot;).length - 1]).prop( &quot;checked&quot;, true );
        }
      }

      $featureSearch.addEventListener(
        &quot;keyup&quot;,
        debounce((event) =&gt; {
          searchString = event.target.value.toLowerCase();
          handleSearch();
        }, 100),
      );

      $discrete.addEventListener(&quot;change&quot;, (event) =&gt; {
        const currentCheckbox = $(event.currentTarget);

        if (event.currentTarget.checked) {
          activeTypes[&quot;failed&quot;] = true;
          checkedBoxes();
        } else {
          activeTypes[&quot;failed&quot;] = false;
          $($(&quot;.form-check-input&quot;)[$(&quot;.form-check-input&quot;).length - 1]).prop( &quot;checked&quot;, false );
        }
        handleSearch();
      });

      $nonDiscrete.addEventListener(&quot;change&quot;, (event) =&gt; {
        const currentCheckbox = $(event.currentTarget);

        if (event.currentTarget.checked) {
          activeTypes[&quot;passed&quot;] = true;
          checkedBoxes();
        } else {
          activeTypes[&quot;passed&quot;] = false;
          $($(&quot;.form-check-input&quot;)[$(&quot;.form-check-input&quot;).length - 1]).prop( &quot;checked&quot;, false );
        }
        handleSearch();
      });

      $unknown.addEventListener(&quot;change&quot;, (event) =&gt; {
        const currentCheckbox = $(event.currentTarget);

        if (event.currentTarget.checked) {
          $(&quot;.form-check-input&quot;).prop( &quot;checked&quot;, true );
          activeTypes[&quot;passed&quot;] = true;
          activeTypes[&quot;failed&quot;] = true;
          checkedBoxes();
        } else {
          $(&quot;.form-check-input&quot;).prop( &quot;checked&quot;, false );
          activeTypes[&quot;passed&quot;] = false;
          activeTypes[&quot;failed&quot;] = false;
        }
        handleSearch();
      });
    }

    function checkedBoxes() {
      const $boxes = $(&#x27;input[name=checkbox]:checked&#x27;);
      const $notifCircleContainer = $(&quot;.notif-circle-container&quot;)

      if ($boxes.length) {
        $notifCircleContainer.removeClass(&quot;d-none&quot;)
      }
    }

    function openFilter() {
      const $filterOptions = $(&quot;.dropdown-container&quot;);
      const $notifCircleContainer = $(&quot;.notif-circle-container&quot;)
      const filterClass = $filterOptions.attr(&quot;class&quot;);

      if (filterClass.indexOf(&quot;d-none&quot;) &gt; 0) {
        $notifCircleContainer.addClass(&quot;d-none&quot;)
        $filterOptions.removeClass(&quot;d-none&quot;);
        $(&quot;.filter-icon&quot;).addClass(&quot;d-none&quot;)
        $(&quot;.close-filter-icon&quot;).removeClass(&quot;d-none&quot;)
      } else {
        $filterOptions.addClass(&quot;d-none&quot;);
        $(&quot;.close-filter-icon&quot;).addClass(&quot;d-none&quot;)
        $(&quot;.filter-icon&quot;).removeClass(&quot;d-none&quot;)
        checkedBoxes()
      }
    }

    // Invoke functions -- keep in mind invokation order
    registerHandlebarHelperFunctions();
    initHandlebarsTemplate();
    initWebsiteScripts();
  &lt;/script&gt;
&lt;/html&gt;
" width=100% height=300
        frameBorder=0></iframe></div>
</div>
<p>Looks like we have some missing values for <code class="docutils literal notranslate"><span class="pre">last_review</span></code>. Other than that, the data looks good!</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, whylogs developers
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://bit.ly/whylogs-slack" aria-label="Slack">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512"><path d="M213.6
            236.216l64.003-21.438 20.708 61.823-64.004
            21.438z"></path><path d="M213.6 236.216l64.003-21.438 20.708 61.823-64.004 21.438z"></path><path
            d="M475.9 190C426.4 25 355-13.4 190 36.1S-13.4 157 36.1 322 157 525.4 322 475.9 525.4 355 475.9
            190zm-83.3 107.1l-31.1 10.4 10.7 32.2c4.2 13-2.7 27.2-15.7 31.5-2.7.8-5.8 1.5-8.4
            1.2-10-.4-19.6-6.9-23-16.9l-10.7-32.2-64.1 21.5L261 377c4.2 13-2.7 27.2-15.7 31.5-2.7.8-5.8 1.5-8.4
            1.2-10-.4-19.6-6.9-23-16.9L203 360.4l-31 10.3c-2.7.8-5.8 1.5-8.4 1.2-10-.4-19.6-6.9-23-16.9-4.2-13
            2.7-27.2 15.7-31.5l31.1-10.4-20.7-61.8-31.1 10.4c-2.7.8-5.8 1.5-8.4 1.2-10-.4-19.6-6.9-23-16.9-4.2-13
            2.7-27.2 15.7-31.5l31.1-10.4-10.9-32.1c-4.2-13 2.7-27.2 15.7-31.5 13-4.2 27.2 2.7 31.5 15.7l10.7 32.2
            64.1-21.5-10.7-32.2c-4.2-13 2.7-27.2 15.7-31.5 13-4.2 27.2 2.7 31.5 15.7l10.7 32.2 31.1-10.4c13-4.2 27.2
            2.7 31.5 15.7 4.2 13-2.7 27.2-15.7 31.5l-31.1 10.4 20.7 61.8 31.1-10.4c13-4.2 27.2 2.7 31.5 15.7 4.2
            13.2-2.7 27.4-15.8 31.7z"></path></svg>
            </a>
              <a class="muted-link " href="https://github.com/whylabs/whylogs" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38
                    0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53
                    .63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95
                    0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0
                    1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87
                    3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16
                    8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Data Validation for Spark Dataframes with whylogs</a><ul>
<li><a class="reference internal" href="#About-the-Dataset---🛏️-Airbnb-Listings-in-Rio-de-Janeiro,-Brazil">About the Dataset - 🛏️ Airbnb Listings in Rio de Janeiro, Brazil</a></li>
<li><a class="reference internal" href="#Installing-the-extra-dependency">Installing the extra dependency</a></li>
<li><a class="reference internal" href="#Initializing-a-SparkSession">Initializing a SparkSession</a></li>
<li><a class="reference internal" href="#Creating-the-PySpark-dataframe">Creating the PySpark dataframe</a></li>
<li><a class="reference internal" href="#Creating-the-Condition-Count-Metrics">Creating the Condition Count Metrics</a></li>
<li><a class="reference internal" href="#Profiling-the-PySpark-DataFrame">Profiling the PySpark DataFrame</a></li>
<li><a class="reference internal" href="#Creating-and-Visualizing-Metric-Constraints">Creating and Visualizing Metric Constraints</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    </body>
</html>